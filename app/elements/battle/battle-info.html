<link rel="import" href="/bower_components/paper-material/paper-material.html">
<link rel="import" href="/elements/markdown/render-markdown.html">
<link rel="import" href="battle-spell.html">

<dom-module id="battle-info">
	<style>
		:host {
			display: block;
			height: 100%;
			width: 70%;
			margin-left: 15%;
			margin-right: 15%;
		}
		paper-material {
			background: white;
			margin: 16px;
			padding: 16px;
		}
		.playerCard {
			width: calc(50% - 64px);
			height: 650px;
		}
	</style>
	<template>
		<paper-material elevation="1">
			<h1>Battle info</h1>
			<h3>{{token}}</h3>
			<render-markdown markdown="{{overview}}"></render-markdown>
		</paper-material>
		<div class="horizontal layout center-center wrap">
			<template is="dom-repeat" items="{{players}}" as="player">
				<paper-material elevation="1" class="playerCard">
					<h3>{{player.name}}</h3>
					<p>{{player.description}}</p>
					<p><span>Attack range: </span>{{player.range}}</p>
					<h4>Spells</h4>
					<template is="dom-repeat" items="{{player.spells}}" as="spell">
						<battle-spell spell="{{spell}}"></battle-spell>
					</template>
				</paper-material>
			</template>
		</div>
	</template>
	<script>
		Polymer({
			is: 'battle-info',
			refreshToken: function(){
				var token = localStorage.token;
				if(token){
					this.token = 'Your token is ' + token;
				}
			},
			ready: function(){
				this.refreshToken();
				this.overview = 'In this game there are 4 different classes. \n\n';
				this.overview = this.overview + 'You have __100 free memory (hp)__ in the beginning and your goal is to bring as many enemies as you can to 0 free memory.\n';
				this.overview = this.overview + 'After you reach 0 free memory you will have a __swap memory (respawn)__ time of 10 seconds and then you will be placed random on the map.\n\n';
				this.overview = this.overview + 'The first level is __0__. You level up after you kill __3 enemies__.\n';
				this.overview = this.overview + 'Every class has 5 skills. You get a new skill once you level up (so at level 4 you can use all the skills). In the player descriptions the spells are __ordered by the index you need to use (0-4)__.\n';
				this.overview = this.overview + 'The basic attack damage is 5. Every player can move once a second and attack once a second.\n\n\n';
				this.overview = this.overview + '__We wrote a Java client lib here https://github.com/coduno/java-battle-client . Clone it and create an Application class with a main function in the package BattleHelper.java is. Have fun!__';

				var shebagNinja = {
					name: 'Shebang Ninja',
					description: 'Prefers shell over GUI and knows all manual pages by heart.',
					range: 2,
					spells: [
						{
							name: 'bc',
							type: 'damage',
							info: 'The arbitrary precision calculator enables you to do the math in order to attack an enemy.',
							cooldown: 20,
							range: 2,
							power: 15
						},
						{
							name: 'dd',
							type: 'custom',
							info: 'Use the data destroyer to permanently corrupt a square of the map.',
							cooldown: 25,
							range: 2,
							extraInfo: ''
						},
						{
							name: 'sudo',
							type: 'custom',
							info: 'Gives you permission to take control of an enemy player and issue a move command.',
							cooldown: 20,
							range: 2,
							extraInfo: 'Pass an extra string that states "move DIRECTION".'
						},
						{
							name: 'chmod',
							type: 'custom',
							info: 'Fiddle with the enemy\'s permission bits.',
							cooldown: 40,
							range: 2,
							extraInfo: 'The extra string represents the permission you remove from your enemy him(freeze - remove move, disarm - remove attack, silence - remove spell)'
						},
						{
							name: 'sleep',
							type: 'stun',
							info: 'The sleep command stuns an enemy.',
							cooldown: 15,
							duration: 2,
							range: 3
						}
					]
				};
				var gopher = {
					name: 'Gopher',
					description: 'A systems programmer that is fed up with the humongous feature list of C++11 and lives the dream of comprehensible code.',
					range: 3,
					spells: [
						{
							name: 'func main()',
							type: 'heal',
							info: 'Like in your old C/C++ times, main is home to you. The the comfort of argument parsing strengthens you and at the same time deals damage to all those around you who do not appreciate Go the same as you do.',
							cooldown: 35,
							power: 10
						},
						{
							name: 'runtime.GarbageCollect()',
							type: 'custom',
							info: 'Kills all players in a certain radius that have less than ten bytes of free memory.',
							cooldown: 60,
							range: 2
						},
						{
							name: 'sync.RWLock',
							type: 'custom',
							info: 'Read-write locks two enemies. Their commands will be carried out only if one of them casts a spell and the other one moves.',
							cooldown: 60,
							extraInfo: 'The extra string must be the two names of the players. The first one will be spell locked and the second move locked. (e.g.: "wizard42 runner1337")'
						},
						{
							name: 'Goroutine Wrath',
							type: 'dot',
							info: 'Releases the wrath of a million Goroutines. You will deal 5 damage every 2 seconds 5 times.',
							range: 3,
							power: 25
						},
						{
							name: 'Segmentation Fault',
							type: 'stun',
							info: 'Oops!',
							cooldown: 15,
							duration: 2,
							range: 3
						}
					]
				};
				var ipPacket = {
					name: 'IP Packet',
					description: 'IP Packets drive our information society, although many don\'t realize it. Tinker with that endless flow of information.',
					range: 1,
					spells: [
						{
							name: 'UDP Flood',
							type: 'kick',
							info: 'An enemy is pushed back by the sheer force of your UDP flood.',
							cooldown: 20,
							power: 3
						},
						{
							name: 'DDoS',
							type: 'stun',
							info: 'By directing so much traffic at an enemy, you can stop him from moving.',
							cooldown: 20,
							duration: 2,
							range: 2
						},
						{
							name: 'IPv6',
							type: 'custom',
							info: 'As the others are not running on IPv6 yet, they cannot harm you for five seconds.',
							cooldown: 40
						},
						{
							name: 'ping',
							type: 'damage',
							info: 'Send an ICMP Echo Request to your enemy. If he is not an IP Packet as well, he will be dealt damage.',
							cooldown: 20,
							damage: 20,
							range: 2
						},
						{
							name: 'Corrupt IP Packet',
							type: 'custom',
							info: 'Corrupt the traffic an enemy sends to the server. His next action will fail.',
							cooldown: 20,
							range: 2
						}
					]
				};
				var j2ee = {
					name: 'J2EE Programmer',
					description: 'Been coding since Java 1.0, rejects everything that does not interop with the JVM and turned full enterprise.',
					range: 1,
					spells: [
						{
							name: 'StackOverflowError',
							type: 'damage',
							info: 'Missed the termination condition on a recursive function, ouch!',
							cooldown: 15,
							damage: 20,
							range: 4
						},
						{
							name: 'Scrum Meeting',
							type: 'slow',
							info: 'A too heavy Scrum meeting demotivates you, but you manage to refelct your demotivation at an enemy and slow him down.',
							cooldown: 20,
							duration: 3,
							range: 4
						},
						{
							name: 'Dependency Injection',
							type: 'custom',
							info: 'You dependency-inject yourself into an enemy player. If you die, he will have to catch a lot of exceptions, dealing 20 damage.',
							cooldown: 60,
						},
						{
							name: 'OutOfMemoryException',
							type: 'heal',
							info: 'Your code generated an OutOfMemoryException, because your code is leaky and always relying on GC made your mind blurry about the concept of process memory. However you go on and tweak your maximum heap size successfully and now can use more memory.',
							cooldown: 30,
							power: 20
						},
						{
							name: 'Stack Trace',
							type: 'stun',
							info: 'Hand a stack trace to an enemy player. He is forced to stop and read to make sense of it, which turns out to be difficult in the world of enterprise-grade Java frameworks.',
							cooldown: 20,
							duration: 3,
							range: 4
						},
					]
				};
				this.players = [shebagNinja, gopher, ipPacket, j2ee];
			}
		});
	</script>
</dom-module>
