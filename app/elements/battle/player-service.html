<script src="/bower_components/pixi.js/bin/pixi.js"></script>
<script>
Polymer({
	is: 'player-service',
	ready: function(){
		this.directions = ['left', 'right', 'up', 'down'];
		this.texture = PIXI.utils.TextureCache['/images/redhead.png'];
	},
	getAnimatedPlayer: function(x, y, size) {
		var animatedPlayer = {
			standing:  this._initClip(x, y, size, [new PIXI.Texture(this.texture, new PIXI.Rectangle(0, 0, 54, 54))]),
			attacking: this._createClip(x, y, size, [0, 54, 108, 432, 486, 540], [594, 540, 486, 432]),
			moving:    this._createClip(x, y, size, [270, 324, 378, 432, 486, 540], [162, 108, 54, 0]),
			casting:   this._createClip(x, y, size, [702, 756, 810], [378, 324, 270, 216])
		};

		var element = this;
		animatedPlayer.addToStage = function(stage) {
			stage.addChild(this.standing);
			for (var i = 0; i < element.directions.length; i++){
				stage.addChild(this.attacking[element.directions[i]]);
				stage.addChild(this.moving[element.directions[i]]);
				stage.addChild(this.casting[element.directions[i]]);
			}
		}

		animatedPlayer.stand = function() {
			for (var i = 0; i < element.directions.length; i++){
				this.attacking[element.directions[i]].visible = false;
				this.moving[element.directions[i]].visible = false;
				this.casting[element.directions[i]].visible = false;
			}
			this.standing.visible = true;
		}
		return animatedPlayer;
	},
	_createClip: function(x, y, size, xValues, yValues) {
		var clips = {};
		for (var i = 0; i < this.directions.length; i++) {
			var animations = [];
			for (var j = 0; j < xValues.length; j++) {
				animations.push(new PIXI.Texture(this.texture, new PIXI.Rectangle(xValues[j], yValues[i], 54, 54)))
			}
			clips[this.directions[i]] = this._initClip(x, y, size, animations);
		}
		return clips;
	},
	_initClip: function(x, y, size, animations) {
		var clip = new PIXI.extras.MovieClip(animations);
		clip.animationSpeed = 0.1;
		clip.position.x = x;
		clip.position.y = y;
		clip.width = size;
		clip.height = size;
		clip.onComplete = function() {
			console.log('Initialized clip!');
		};
	}
});
</script>
